<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=5.0, user-scalable=yes"
    />
    <title>EPhone PWA</title>
    <link rel="stylesheet" href="style.css" />
    <link
      rel="apple-touch-icon"
      href="https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg"
    />
    <link rel="manifest" href="manifest.json" />
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="EPhone" />
    <meta name="mobile-web-app-capable" content="yes" />
    <link
      rel="icon"
      type="image/png"
      href="https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg"
    />
    <meta name="theme-color" content="#f0f2f5" />
<style>
    /* --- æ ¸å¿ƒå˜é‡ï¼šå¥¶æ²¹è‰è“æœå†»é£ --- */
    :root {
        --jelly-pink: rgba(255, 192, 203, 0.92); /* æœå†»ç²‰ä¸»ä½“ */
        --cream-white: #fff0f5;   /* å¥¶æ²¹ç™½ */
        --deep-candy: #e91e63;    /* ç³–æœçº¢æ·±è‰²æ–‡å­— */
        --tape-dark: #795548;     /* ç£å¸¦æ¡é¢œè‰² */
        --soft-shadow: 8px 8px 0px rgba(233, 30, 99, 0.15); /* è½¯èŒçš„é˜´å½± */
    }

    html { -webkit-text-size-adjust: 100%; height: 100%; }
    
    /* --- 1. èƒŒæ™¯å‡çº§ï¼šç²‰æ ¼çº¹ + é—ªçƒæ˜Ÿæ˜Ÿ --- */
    body {
        margin: 0;
        font-family: 'DotGothic16', monospace;
        background-color: #fff0f5;
        /* ç²‰ç™½æ ¼çº¹ */
        background-image: 
            linear-gradient(90deg, rgba(255, 192, 203, 0.5) 50%, transparent 50%),
            linear-gradient(rgba(255, 192, 203, 0.5) 50%, transparent 50%);
        background-size: 50px 50px;
        height: 100%; 
        overflow: hidden; 
        color: var(--deep-candy);
        position: relative;
    }

    /* æ˜Ÿæ˜Ÿå±‚ */
    #star-layer {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none; z-index: 0;
        /* ä½¿ç”¨ radial-gradient æ¨¡æ‹Ÿéšæœºæ˜Ÿæ˜Ÿ */
        background-image: 
            radial-gradient(2px 2px at 20px 30px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 40px 70px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 50px 160px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 90px 40px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 130px 80px, #fff, rgba(0,0,0,0)),
            radial-gradient(2px 2px at 160px 120px, #fff, rgba(0,0,0,0));
        background-repeat: repeat;
        background-size: 200px 200px;
        animation: twinkle 4s infinite ease-in-out;
        opacity: 0.6;
    }

    @keyframes twinkle {
        0%, 100% { opacity: 0.3; transform: scale(1); }
        50% { opacity: 0.8; transform: scale(1.1); }
    }

    /* --- 2. æ¨±èŠ±è°ƒæ•´ --- */
    #sakura-container {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        pointer-events: none; z-index: 1; overflow: hidden;
    }
    .sakura {
        position: absolute; top: -50px; /* èµ·å§‹ä½ç½®æ›´é ä¸Š */
        background: linear-gradient(120deg, #ffcdd2, #fff);
        border-radius: 15px 0px 15px 0px;
        opacity: 0; /* åˆå§‹é€æ˜ */
        /* åŠ¨ç”»åœ¨è¿™é‡Œç”± JS åŠ¨æ€å†™å…¥ï¼ŒCSSé‡Œåªä¿ç•™åŸºæœ¬å±æ€§ */
    }
    @keyframes fall {
        0% { opacity: 0; top: -50px; transform: translateX(0) rotate(0deg); }
        20% { opacity: 0.8; }
        100% { opacity: 0; top: 100vh; transform: translateX(50px) rotate(360deg); }
    }
    /* å™ªç‚¹çº¹ç†ï¼Œå¢åŠ å¤å¤æ„Ÿ */
    body::after {
        content: ""; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.08'/%3E%3C/svg%3E");
        pointer-events: none; z-index: 9999; opacity: 0.3;
    }

    #phone-screen {
        width: 100%; height: 100vh; position: relative; overflow: hidden; display: flex; flex-direction: column;
        /* è¿™é‡Œçš„èƒŒæ™¯è®¾ä¸ºé€æ˜ï¼Œè®©bodyçš„æ³¢ç‚¹é€å‡ºæ¥ */
        background: transparent; 
    }

    /* çœç•¥é€šç”¨å¸ƒå±€... */
    .screen, #home-screen-pages, .home-screen-page, #main-content-area {
        width: 100%; height: 100%; display: flex; flex-direction: column;
        overflow: hidden; position: relative;
    }
    #home-screen { padding: 20px 0; box-sizing: border-box; z-index: 10; }
    #home-screen-pages-container { flex-grow: 1; }
    #home-screen-pages { flex-direction: row; }
    .home-screen-page, #main-content-area { align-items: center; justify-content: center; }

    /* --- æ¡Œé¢å¸ƒå±€ (ç£å¸¦åŒºåŸŸ) --- */
    #desktop-layout {
        display: flex; justify-content: center; align-items: center;
        padding: 0 20px; box-sizing: border-box;
    }
    
    /* ç£å¸¦ä¸»ä½“ */
#cassette-tape {
    max-width: 330px; /* ã€ä¿®æ”¹ã€‘è®¾ç½®ä¸€ä¸ªæœ€å¤§å®½åº¦ */
    width: 95%;       /* ã€ä¿®æ”¹ã€‘è®©å®ƒåœ¨å°å±å¹•ä¸Šè‡ªåŠ¨ç¼©æ”¾ */
    height: 210px;
    background: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0.2)), var(--jelly-pink);
    backdrop-filter: blur(8px);
    border-radius: 20px;
    border: 3px solid white;
    box-shadow: var(--soft-shadow);
    position: relative;
    display: flex; flex-direction: column;
    padding: 12px; box-sizing: border-box;
}

    /* æ¼‚æµ®åŠ¨ç”» */
    .floating { animation: float 3s ease-in-out infinite; }
    @keyframes float {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-8px); }
        100% { transform: translateY(0px); }
    }

    /* èºä¸é’‰ (åšæˆçˆ±å¿ƒè‰²) */
    .screw {
        position: absolute; width: 10px; height: 10px;
        background: #f8bbd0; border-radius: 50%;
        box-shadow: inset 1px 1px 2px white;
    }
    .tl { top: 10px; left: 10px; } .tr { top: 10px; right: 10px; }
    .bl { bottom: 10px; left: 10px; } .br { bottom: 10px; right: 10px; }

    /* é¡¶éƒ¨è´´çº¸ */
.cassette-header {
    height: 40px; background: white;
    margin: 0 0 8px 0; /* ã€ä¿®æ”¹ã€‘å»æ‰äº†å·¦å³å¤–è¾¹è· */
    transform: rotate(-1deg);
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    display: flex; align-items: center; justify-content: center;
}

    .sticker-label {
        width: 100%; text-align: center;
        border: 2px dashed #f48fb1; border-radius: 6px; margin: 3px; height: calc(100% - 6px);
        display: flex; justify-content: space-around; align-items: center;
    }
    .tape-name { font-weight: bold; color: var(--deep-candy); font-size: 16px; letter-spacing: 1px; }
    .tape-time { background: var(--deep-candy); color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; }

    /* ä¸­é—´çª—å£ */
    .magnetic-window {
        flex-grow: 1;
        background: rgba(255,255,255,0.3);
        border-radius: 15px; border: 2px solid white;
        margin: 0 5px; position: relative;
        display: flex; justify-content: space-between; align-items: center;
        padding: 0 30px;
    }

    /* ç£å¸¦æ¡ */
    .tape-strip {
        position: absolute; top: 50%; left: 10%; width: 80%; height: 35px;
        background: var(--tape-dark); transform: translateY(-50%); z-index: 0;
        border-radius: 4px; opacity: 0.8;
    }

    /* è½¬è½´å®¹å™¨ */
    .spool-container {
        position: relative; z-index: 1;
        width: 70px; height: 70px; /* å®¹å™¨å¤§å° */
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        cursor: pointer; -webkit-tap-highlight-color: transparent;
        transition: transform 0.1s;
    }
    .spool-container:active { transform: scale(0.9); }

    /* ç£å¸¦å· (ä¸¤ä¸ªç°åœ¨ä¸€æ ·å¤§äº†) */
    .tape-roll {
        position: absolute; width: 68px; height: 68px;
        border-radius: 50%; background: var(--tape-dark); z-index: -1;
        box-shadow: 0 0 0 3px rgba(121, 85, 72, 0.3);
    }

    /* é½¿è½®è£…é¥° */
    .spool-gear {
        position: absolute; width: 74px; height: 74px;
        border-radius: 50%; border: 2px dashed white;
        animation: rotateGear 8s linear infinite;
    }
    .right .spool-gear { animation-direction: reverse; }
    @keyframes rotateGear { to { transform: rotate(360deg); } }

    /* æ ¸å¿ƒï¼šå›¾æ ‡å­” */
    .spool-hole {
        width: 48px; height: 48px;
        background: white; border-radius: 50%;
        border: 4px solid white; overflow: hidden;
        box-shadow: inset 1px 1px 3px rgba(0,0,0,0.2);
    }
    .spool-hole img { width: 100%; height: 100%; object-fit: cover; }

    /* æ‰‹å†™æ ‡ç­¾ */
    .handwritten-label {
        position: absolute; bottom: -28px;
        background: #fff; color: var(--deep-candy);
        padding: 3px 10px; border-radius: 10px;
        font-size: 12px; font-weight: bold;
        box-shadow: 2px 2px 0 rgba(0,0,0,0.05);
        transform: rotate(-3deg); border: 1px solid #ffcdd2;
    }
    .right .handwritten-label { transform: rotate(3deg); }

    /* åº•éƒ¨è£…é¥° */
    .cassette-bottom { height: 15px; }

    /* --- æ‚¬æµ®æŒ‰é’® (é»‘èƒ¶å”±ç‰‡) --- */
    #fab-container {
        position: fixed; bottom: 80px; right: 20px; z-index: 1000;
        width: 64px; height: 64px; display: block;
        transition: opacity 0.3s; /* éšèº«è¿‡æ¸¡æ•ˆæœ */
    }

    /* ï¼ï¼ï¼æ ¸å¿ƒä¿®æ”¹ï¼šçœŸæ­£çš„éšèº«æ¨¡å¼ï¼ï¼ï¼ */
    #fab-container.ghost-mode {
        opacity: 0; /* å®Œå…¨é€æ˜ï¼Œçœ‹ä¸è§ */
        pointer-events: auto; /* ä½†æ˜¯å¯ä»¥ç‚¹å‡»ï¼ */
    }
    /* å½“åœ¨éšèº«æ¨¡å¼ä¸‹ï¼Œä¸”èœå•è¢«ç‚¹å¼€äº†ï¼Œå°±æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸ç„¶æ‰¾ä¸åˆ°èœå•äº† */
    #fab-container.ghost-mode.menu-open {
        opacity: 1;
    }

    #fab-main {
        width: 64px; height: 64px; border-radius: 50%; cursor: pointer;
        display: flex; justify-content: center; align-items: center; position: relative;
        /* é»‘èƒ¶è´¨æ„Ÿ */
        background: repeating-radial-gradient(#222 0, #222 2px, #333 3px, #333 4px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        -webkit-tap-highlight-color: transparent;
    }
    /* é»‘èƒ¶é«˜å…‰ */
    #fab-main::after {
        content: ''; position: absolute; top:0; left:0; width:100%; height:100%;
        border-radius: 50%;
        background: linear-gradient(135deg, transparent 40%, rgba(255,255,255,0.3) 50%, transparent 60%);
        pointer-events: none;
    }
    /* é»‘èƒ¶ä¸­å¿ƒ */
    #fab-main::before {
        content: ''; position: absolute; width: 26px; height: 26px;
        background: var(--deep-candy); border-radius: 50%; border: 6px solid #f8bbd0;
    }
    #fab-main svg { position: relative; z-index: 2; width: 20px; fill: white; }

    /* æ—‹è½¬åŠ¨ç”» */
    #fab-container.menu-open #fab-main { animation: spin 4s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* èœå•é¡¹ */
    .fab-actions {
        position: absolute; bottom: 80px; right: 5px; display: flex; flex-direction: column; align-items: flex-end; gap: 12px;
        opacity: 0; visibility: hidden; pointer-events: none;
        transform: translateY(20px) scale(0.9); transition: all 0.2s;
    }
    #fab-container.menu-open .fab-actions { opacity: 1; visibility: visible; pointer-events: auto; transform: translateY(0) scale(1); }

    .fab-mini-btn {
        width: 44px; height: 44px; background: white; border-radius: 50%;
        border: 2px solid var(--deep-candy); color: var(--deep-candy);
        display: flex; justify-content: center; align-items: center;
        box-shadow: 2px 2px 0 rgba(233, 30, 99, 0.1);
    }
    .fab-label {
        background: white; color: var(--deep-candy); padding: 4px 8px; border-radius: 6px;
        font-size: 12px; margin-right: 8px; border: 1px solid #f8bbd0;
        box-shadow: 2px 2px 0 rgba(233, 30, 99, 0.1);
    }

    /* App çª—å£åŠå…¶ä»– */
    .app-window {
        width: 100%; height: 100%; position: absolute; top: 0; left: 0; background: white;
        z-index: 50; display: none; flex-direction: column; opacity: 0; transform: scale(0.95);
        transition: all 0.3s;
    }
    .app-window.active { display: flex; opacity: 1; transform: scale(1); }
    .app-iframe { width: 100%; height: 100%; border: none; }
    
    #toast-msg {
        position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
        background: white; color: var(--deep-candy); border: 2px solid var(--deep-candy);
        padding: 8px 20px; border-radius: 20px; font-size: 14px; z-index: 2000;
        opacity: 0; visibility: hidden; transition: opacity 0.2s;
        box-shadow: 4px 4px 0 rgba(233, 30, 99, 0.15);
    }
    #toast-msg.show { opacity: 1; visibility: visible; }
        /* --- æ–°å¢ï¼šç¡®ä¿æ ‡ç­¾å’ŒæŒ‰é’®æ¨ªå‘æ’åˆ—ï¼Œä¸”æ ‡ç­¾åœ¨å·¦è¾¹ --- */
    .fab-action-btn {
        display: flex;
        align-items: center;      /* å‚ç›´å±…ä¸­ */
        justify-content: flex-end; /* æ•´ä½“é å³ */
        cursor: pointer;
    }
    
    /* ç¨å¾®è°ƒæ•´ä¸€ä¸‹ fab-label çš„æ ·å¼ï¼Œå»æ‰ä¸å¿…è¦çš„ margin */
    .fab-label {
        background: white; 
        color: var(--deep-candy); 
        padding: 4px 8px; 
        border-radius: 6px;
        font-size: 12px; 
        margin-right: 12px; /* æ ‡ç­¾å’ŒæŒ‰é’®ä¹‹é—´çš„è·ç¦» */
        border: 1px solid #f8bbd0;
        box-shadow: 2px 2px 0 rgba(233, 30, 99, 0.1);
        white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
    }
    
    /* è°ƒæ•´ mini-btn æ ·å¼ä»¥é€‚é…å›¾ç‰‡ */
    .fab-mini-btn {
        width: 44px; height: 44px; 
        background: white; 
        border-radius: 50%;
        border: 2px solid var(--deep-candy); 
        color: var(--deep-candy);
        display: flex; justify-content: center; align-items: center;
        box-shadow: 2px 2px 0 rgba(233, 30, 99, 0.1);
        overflow: hidden; /* ç¡®ä¿å›¾ç‰‡è£å‰ªæˆåœ†å½¢ */
        padding: 0;       /*ä»¥æ­¤ç¡®ä¿å›¾ç‰‡å æ»¡ */
    }
    
    /* æ–°å¢ï¼šè®©é‡Œé¢çš„å›¾ç‰‡å æ»¡æŒ‰é’® */
    .fab-mini-btn img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    /* æ–°å¢ï¼šSVG å›¾æ ‡çš„é¢œè‰²æ ·å¼ */
    .fab-mini-btn svg {
        width: 24px;
        height: 24px;
        fill: var(--deep-candy); /* å›¾æ ‡é¢œè‰² */
    }

</style>

  </head>
  <body>
    <!-- 1. æ–°å¢ï¼šæ˜Ÿæ˜ŸèƒŒæ™¯å±‚ -->
    <div id="star-layer"></div>
    <!-- æ¨±èŠ±å®¹å™¨ä¿æŒä¸å˜ -->
    <div id="sakura-container"></div>

    <div id="phone-screen">
      <div id="home-screen" class="screen">
        <div id="home-screen-pages-container">
          <div id="home-screen-pages">
            <div class="home-screen-page">
              <div id="main-content-area">
<div id="desktop-layout">
    <!-- å¢åŠ äº†ä¸€ä¸ª float åŠ¨ç”»ç±»ï¼Œè®©ç£å¸¦åƒåœ¨å¤ªç©ºä¸­ä¸€æ ·å¾®å¾®æ¼‚æµ® -->
    <div id="cassette-tape" class="floating">
        <!-- è£…é¥°èºä¸ (æ¢æˆç²‰è‰²) -->
        <div class="screw tl"></div>
        <div class="screw tr"></div>
        <div class="screw bl"></div>
        <div class="screw br"></div>

        <!-- é¡¶éƒ¨è´´çº¸ -->
        <div class="cassette-header">
            <div class="sticker-label">
                <span class="tape-name">ğŸ’– Ephone MIX ğŸ’–</span>
                <span class="tape-time">A side</span>
            </div>
        </div>

        <!-- ç£å¸¦æ ¸å¿ƒåŒºåŸŸ -->
        <div class="magnetic-window">
            <!-- å·¦è¾¹çš„ App (330) -->
            <div class="spool-container left" onclick="openApp('app-a')">
                <div class="spool-gear"></div>
                <div class="spool-hole">
                    <img src="https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg" alt="App A">
                </div>
                <!-- æ³¨æ„ï¼šè¿™é‡Œçš„ tape-roll ç°åœ¨ä¸¤è¾¹å®Œå…¨ä¸€æ ·äº† -->
                <div class="tape-roll"></div>
                <span class="handwritten-label">330</span>
            </div>

            <!-- ä¸­é—´ç£æ¡ -->
            <div class="tape-strip"></div>

            <!-- å³è¾¹çš„ App (å…”K) -->
            <div class="spool-container right" onclick="openApp('app-b')">
                <div class="spool-gear"></div>
                <div class="spool-hole">
                    <img src="https://i.postimg.cc/Kj8JnRcp/267611-CC01-F8-A3-B4910-A2-C2-FFDE479-DC.jpg" alt="App B">
                </div>
                <!-- è¿™é‡Œçš„ tape-roll ä¹Ÿæ²¡æœ‰ small ç±»äº† -->
                <div class="tape-roll"></div>
                <span class="handwritten-label">å…”K</span>
            </div>
        </div>

        <!-- åº•éƒ¨è£…é¥° -->
        <div class="cassette-bottom"></div>
    </div>
</div>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- App A é¡µé¢ (å…¨å± Iframe) -->
      <div id="app-a" class="app-window app-frame">
        <iframe data-src="https://cx3300-1.github.io/ooooka/" src="" class="app-iframe"></iframe>
      </div>

      <div id="app-b" class="app-window app-frame">
        <iframe data-src="https://cx3300-1.github.io/-k-/" src="" class="app-iframe"></iframe>
      </div>

      <!-- æ‚¬æµ®æŒ‰é’® -->
      <div id="fab-container">
        <div class="fab-actions">
          <!-- 330 æŒ‰é’®ï¼šä½¿ç”¨å›¾ç‰‡ -->
          <div class="fab-action-btn" onclick="openApp('app-a')">
            <span class="fab-label">330</span>
            <div class="fab-mini-btn" style="border-color: #fff;">
                <img src="https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg" alt="330">
            </div>
          </div>

          <!-- å…”K æŒ‰é’®ï¼šä½¿ç”¨å›¾ç‰‡ -->
          <div class="fab-action-btn" onclick="openApp('app-b')">
            <span class="fab-label">å…”K</span>
            <div class="fab-mini-btn" style="border-color: #fff;">
                <img src="https://i.postimg.cc/Kj8JnRcp/267611-CC01-F8-A3-B4910-A2-C2-FFDE479-DC.jpg" alt="å…”K">
            </div>
          </div>

          <!-- éšè—æŒ‰é’®ï¼šä½¿ç”¨ SVG å›¾æ ‡ (çœ¼ç›å…³é—­) -->
          <div class="fab-action-btn" onclick="hideFab()">
            <span class="fab-label">éšè—æŒ‰é’®</span>
            <div class="fab-mini-btn">
                <svg viewBox="0 0 24 24">
                    <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"></path>
                </svg>
            </div>
          </div>

          <!-- ä¸»é¡µæŒ‰é’®ï¼šä½¿ç”¨ SVG å›¾æ ‡ (æˆ¿å­) -->
          <div class="fab-action-btn" onclick="goHome()">
            <span class="fab-label">ä¸»é¡µ</span>
            <div class="fab-mini-btn">
                <svg viewBox="0 0 24 24">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"></path>
                </svg>
            </div>
          </div>
        </div>


        <div id="fab-main"></div>
      </div>

      <div id="toast-msg"></div>
    </div>

    <script>
      const fabContainer = document.getElementById('fab-container');
      const fabMain = document.getElementById('fab-main');

      // è¿™é‡ŒæŠŠåŸæ¥çš„ id="home-screen" å¯¹åº”ç»™ launcherScreen
      const launcherScreen = document.getElementById('home-screen');

      // è·å–æ‰€æœ‰çš„ App çª—å£
      const frames = document.querySelectorAll('.app-frame');
      const toastMsg = document.getElementById('toast-msg');

      // å›¾æ ‡å®šä¹‰
      const menuIconSvg =
        '<svg viewBox="0 0 24 24"><path d="M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zm0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zM3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1z"/></svg>';
      const closeIconSvg =
        '<svg viewBox="0 0 24 24"><path d="M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7a.996.996 0 1 0-1.41 1.41L10.59 12 5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"/></svg>';

      // åˆå§‹åŒ–å›¾æ ‡
      fabMain.innerHTML = menuIconSvg;

      // --- 2. æ ¸å¿ƒåŠŸèƒ½é€»è¾‘ ---

      function openApp(frameId) {
        document.body.classList.add('app-open');

        // ã€ä¿®æ”¹ã€‘éšè—ä¸»å±å¹•ï¼šä» opacity æ”¹ä¸º display: noneï¼Œè®©å®ƒå½»åº•ä¸å ç©ºé—´
        launcherScreen.style.display = 'none'; 
        // transform å¯ä»¥ä¿ç•™ï¼Œä½†å› ä¸ºå…ƒç´ å·²æ¶ˆå¤±ï¼Œæ•ˆæœä¸æ˜æ˜¾ï¼Œä¹Ÿå¯ä»¥åˆ æ‰
        // launcherScreen.style.transform = 'scale(0.95)'; 

        frames.forEach(frame => {
          if (frame.id === frameId) {
            // æ¿€æ´»å½“å‰ App
            frame.style.display = 'flex';
            setTimeout(() => frame.classList.add('active'), 10);

            // æ ¸å¿ƒçœæµé€»è¾‘ï¼šå¦‚æœ src ç©ºæ‰èµ‹å€¼
            const iframe = frame.querySelector('iframe');
            if (iframe && iframe.dataset.src) {
              iframe.src = iframe.dataset.src;
            }
          } else {
            // å…³é—­å…¶ä»– App
            frame.classList.remove('active');
            frame.style.display = 'none';
            const iframe = frame.querySelector('iframe');
            if (iframe) iframe.src = ''; // æ¸…ç†å†…å­˜
          }
        });
        closeMenu();
      }

      function goHome() {
        document.body.classList.remove('app-open');

        // ã€ä¿®æ”¹ã€‘æ¢å¤ä¸»å±å¹•ï¼šä» opacity æ”¹ä¸º display: flex
        launcherScreen.style.display = 'flex'; 
        // transform åŠ¨ç”»ä¹Ÿæ¢å¤ï¼Œè®©å‡ºç°æ›´è‡ªç„¶
        launcherScreen.style.transform = 'scale(1)'; 
        // å…³é—­æ‰€æœ‰ App
        setTimeout(() => {
          frames.forEach(frame => {
            frame.classList.remove('active');
            frame.style.display = 'none';
            // æ¸…ç† iframe
            const iframe = frame.querySelector('iframe');
            if (iframe) iframe.src = '';
          });
        }, 300);
        closeMenu();

        // å›åˆ°ä¸»é¡µæ—¶ï¼Œå¦‚æœå¤„äºéšèº«æ¨¡å¼ï¼Œè‡ªåŠ¨æ¢å¤æ˜¾ç¤ºï¼ˆå¯é€‰ï¼Œå·²æ³¨é‡Šï¼‰
        // showFab();
      }

      // --- [æ–°å¢] éšè—åŠŸèƒ½ ---
      function hideFab() {
        closeMenu();

        // --- æ ¸å¿ƒä¿®æ”¹ ---
        // 1. è·å–ã€é»‘è‰²ä¸»æŒ‰é’®(fab-main)ã€‘åœ¨å±å¹•ä¸Šçš„ä½ç½®
        // æ³¨æ„ï¼šä¸è¦è·å– fabContainer çš„ä½ç½®ï¼Œå› ä¸ºå®ƒåŒ…å«èœå•çš„é«˜åº¦
        const mainRect = fabMain.getBoundingClientRect();

        // 2. å°†å®¹å™¨çš„å·¦ä¸Šè§’ï¼Œç›´æ¥é’‰æ­»åœ¨åœ†çƒå½“å‰çš„ä½ç½®
        // è¿™æ ·å½“èœå•æ¶ˆå¤±ï¼ˆdisplay: noneï¼‰åï¼Œåœ†çƒæ­£å¥½å°±åœ¨è¿™ä¸ªåæ ‡ï¼Œä¸ä¼šä½ç§»
        fabContainer.style.left = mainRect.left + 'px';
        fabContainer.style.top = mainRect.top + 'px';
        fabContainer.style.bottom = 'auto';
        fabContainer.style.right = 'auto';

        // 3. å¼€å¯éšèº«æ¨¡å¼
        // (CSSä¸­ .ghost-mode .fab-actions æ˜¯ display: noneï¼Œæ‰€ä»¥å¿…é¡»ç”¨ä¸Šé¢çš„æ–¹æ³•å®šä½)
        fabContainer.classList.add('ghost-mode');

        showToast('å·²éšè—ã€‚ç‚¹å‡»å½“å‰ä½ç½®å¯å‘¼å‡ºã€‚');
      }

      // æ¢å¤æ˜¾ç¤º
      function showFab() {
        fabContainer.classList.remove('ghost-mode');
      }

      function showToast(text) {
        toastMsg.innerText = text;
        toastMsg.classList.add('show');
        setTimeout(() => {
          toastMsg.classList.remove('show');
        }, 3000);
      }

      function toggleMenu() {
        // å¦‚æœå¤„äºéšèº«æ¨¡å¼ï¼Œç‚¹å‡»ä¸»æŒ‰é’®å°±æ˜¯â€œç°èº«â€
        if (fabContainer.classList.contains('ghost-mode')) {
          showFab();
          // ç°èº«çš„åŒæ—¶ç›´æ¥å±•å¼€èœå•ï¼Œä½“éªŒæ›´æµç•…
          setTimeout(() => {
            fabContainer.classList.add('menu-open');
            fabMain.classList.add('expanded');
            fabMain.innerHTML = closeIconSvg;
          }, 50);
          return;
        }

        fabContainer.classList.toggle('menu-open');
        fabMain.classList.toggle('expanded');

        if (fabMain.classList.contains('expanded')) {
          fabMain.innerHTML = closeIconSvg;
        } else {
          fabMain.innerHTML = menuIconSvg;
        }
      }

      function closeMenu() {
        fabContainer.classList.remove('menu-open');
        fabMain.classList.remove('expanded');
        fabMain.innerHTML = menuIconSvg;
      }

      document.addEventListener('click', e => {
        // åªæœ‰åœ¨èœå•æ‰“å¼€ä¸”ç‚¹å‡»å¤–éƒ¨æ—¶æ‰å…³é—­
        // å¦‚æœæ˜¯éšèº«æ¨¡å¼ç‚¹å‡»äº†ç©ºç™½å¤„ï¼Œä¸éœ€è¦åšä»»ä½•äº‹
        if (!fabContainer.contains(e.target) && fabContainer.classList.contains('menu-open')) {
          closeMenu();
        }
      });

      // --- æ‹–æ‹½åŠŸèƒ½ (ä¿æŒä¸å˜ï¼ŒåŠ äº†éšèº«åˆ¤æ–­) ---
      let isDragging = false;
      let hasMoved = false;
      let startX, startY, initialLeft, initialTop;
      const dragThreshold = 5;

      fabMain.addEventListener('mousedown', startDrag);
      fabMain.addEventListener('touchstart', startDrag, { passive: false });

      function startDrag(e) {
        // å¦‚æœæ˜¯éšèº«æ¨¡å¼ï¼Œç¦æ­¢æ‹–æ‹½ï¼Œåªå…è®¸ç‚¹å‡»
        if (fabContainer.classList.contains('ghost-mode')) {
          return;
        }

        if (fabContainer.classList.contains('menu-open')) {
          closeMenu();
        }

        isDragging = true;
        hasMoved = false;

        if (e.type === 'touchstart') {
          startX = e.touches[0].clientX;
          startY = e.touches[0].clientY;
        } else {
          startX = e.clientX;
          startY = e.clientY;
        }

        const rect = fabContainer.getBoundingClientRect();
        initialLeft = rect.left;
        initialTop = rect.top;

        // å…³é”®ï¼šæ‹–æ‹½å¼€å§‹æ—¶ï¼Œå°†å®šä½åˆ‡æ¢ä¸º left/topï¼Œé˜²æ­¢ CSS bottom/right å¹²æ‰°
        fabContainer.style.bottom = 'auto';
        fabContainer.style.right = 'auto';
        fabContainer.style.left = initialLeft + 'px';
        fabContainer.style.top = initialTop + 'px';

        document.addEventListener('mousemove', onDrag);
        document.addEventListener('touchmove', onDrag, { passive: false });
        document.addEventListener('mouseup', stopDrag);
        document.addEventListener('touchend', stopDrag);
      }

      function onDrag(e) {
        if (!isDragging) return;
        e.preventDefault();

        let clientX, clientY;
        if (e.type === 'touchmove') {
          clientX = e.touches[0].clientX;
          clientY = e.touches[0].clientY;
        } else {
          clientX = e.clientX;
          clientY = e.clientY;
        }

        const deltaX = clientX - startX;
        const deltaY = clientY - startY;

        if (Math.abs(deltaX) > dragThreshold || Math.abs(deltaY) > dragThreshold) {
          hasMoved = true;
        }

        fabContainer.style.left = initialLeft + deltaX + 'px';
        fabContainer.style.top = initialTop + deltaY + 'px';
      }

      function stopDrag() {
        isDragging = false;
        document.removeEventListener('mousemove', onDrag);
        document.removeEventListener('touchmove', onDrag);
        document.removeEventListener('mouseup', stopDrag);
        document.removeEventListener('touchend', stopDrag);
      }

      fabMain.addEventListener('click', e => {
        e.stopPropagation();
        // æ— è®ºæ˜¯æ‹–æ‹½ç»“æŸè¿˜æ˜¯æ™®é€šç‚¹å‡»ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿä½ç§»ï¼Œéƒ½è§†ä¸ºç‚¹å‡»
        if (!hasMoved) {
          toggleMenu();
        }
      });
    // --- 3. æ¨±èŠ±ç”Ÿæˆé€»è¾‘ (ç¨€ç–éšæœºç‰ˆ) ---
      function createSakura() {
        const container = document.getElementById('sakura-container');
        // å‡å°‘æ•°é‡ï¼šåªå…è®¸å±å¹•ä¸ŠåŒæ—¶å­˜åœ¨ 6 ç‰‡ (éå¸¸ç¨€ç–)
        const petalCount = 6; 
        
        for (let i = 0; i < petalCount; i++) {
            const petal = document.createElement('div');
            petal.classList.add('sakura');
            
            // éšæœºå±æ€§
            const startLeft = Math.random() * 100; // 0-100% å®½åº¦
            // å¢åŠ å»¶è¿ŸèŒƒå›´ï¼šè®©èŠ±ç“£åœ¨ 0ç§’ åˆ° 15ç§’ ä¹‹é—´éšæœºå¼€å§‹è½ä¸‹
            // è¿™æ ·å°±ä¸ä¼šä¸€çªèœ‚ä¸‹æ¥ï¼Œè€Œæ˜¯æ–­æ–­ç»­ç»­çš„
            const delay = Math.random() * 15; 
            const duration = Math.random() * 5 + 8; // é£˜è½æ—¶é•¿ 8-13ç§’ (æ›´æ…¢)
            const size = Math.random() * 8 + 10; // 10-18px
            
            petal.style.left = startLeft + '%';
            petal.style.width = size + 'px';
            petal.style.height = size + 'px';
            petal.style.animation = `fall ${duration}s linear ${delay}s infinite`;
            
            container.appendChild(petal);
        }
      }

      // åˆå§‹åŒ–
      window.addEventListener('DOMContentLoaded', createSakura);
      // SW æ³¨å†Œ
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('sw.js');
        });
      }
    </script>
  </body>
</html>
